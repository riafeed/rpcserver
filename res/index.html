<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8">
    <title>RPCのテスト</title>
    <script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.min.js"></script>
    <script type="text/javascript" src="./lib/json2.js"></script>
    <script type="text/javascript" src="./lib/jquery.rpcclient.js"></script>
    <script type="text/javascript">
    <!--
    $(function() {
      $('form').submit(function(){return false;});
      /*
      //非同期版
      $.getRPCClient().loadObject('/', function(obj) {
        var rpcobj = obj;
        $('#invoke').attr('disabled', false);
        $('#invoke').click(function() {
          if(rpcobj === null) return;
          rpcobj.add(function(json) {
            if(json.error) {
              $('#output').html('<span style="color:red;">' + json.error.message + '</span>');
            } else {
              $('#output').html(json.result);
            }
          }, parseInt($('#a').val()), parseInt($('#b').val()));
        });
      });
      */
      //同期版
      var rpcobj = $.getRPCClient().loadObject('/');
      $('#invoke').attr('disabled', false);
      $('#invoke').click(function() {
        var json = rpcobj.add(parseInt($('#a').val()), parseInt($('#b').val()));
        //var json = rpcobj.add5();
        if(json.error) {
          $('#output').html('<span style="color:red;">' + json.error.message + '</span>');
        } else {
          $('#output').html(json.result);
        }
      });
    });
    //-->
    </script>
  </head>
  <body>
    <form>
      <input type="text" id="a" size="3">＋<input type="text" id="b" size="3"><input type="submit" id="invoke" value="＝" disabled>
    </form>
    <div id="output">ここに答えを表示</div>
  </body>
</html>
